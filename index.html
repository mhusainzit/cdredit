<!DOCTYPE html>
<html>
<head>
  <title>Zuber C Mevegar Credit App</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    button, input { padding: 8px; margin: 5px 0; width: 100%; }
    .folder { border: 2px solid #444; padding: 15px; margin-top: 20px; border-radius: 10px; background: #f9f9f9; }
    .folders-list { margin-top: 20px; }
    .flex-row { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
    .flex-row a, .flex-row button { flex: 1; padding: 10px; text-align: center; text-decoration: none; background: #eee; border: none; border-radius: 5px; }
    .folder h3 { margin-bottom: 10px; }
    .total { font-weight: bold; margin: 10px 0; }
  </style>
</head>
<body>

<h2>Your Credit</h2>

<button onclick="createFolder()">â• Add New Folder</button>

<div class="folders-list" id="foldersList"></div>

<script>
let folderId = 0;

function createFolder() {
  const folderName = prompt("Enter folder name:");
  if (!folderName) return;

  const id = ++folderId;

  const folderHTML = `
    <div class="folder" id="folder-${id}">
      <h3>ğŸ“ ${folderName}</h3>

      <label>Product Name:</label>
      <input type="text" id="productName-${id}" placeholder="Enter product name">

      <label>Product Prices (comma separated):</label>
      <input type="text" id="productPrice-${id}" placeholder="e.g. 1200,200,5000" oninput="calculateTotal(${id})">

      <div class="total">Total Amount: â‚¹<span id="total-${id}">0.00</span></div>

      <label>Creditor Phone Number:</label>
      <input type="tel" id="phone-${id}" placeholder="Enter phone number" oninput="updateInitialSMS(${id})">

      <div class="flex-row">
        <a id="call-${id}" href="#">ğŸ“ Call</a>
        <button onclick="deleteFolder(${id})" style="background: #ff4d4d; color: white;">ğŸ—‘ï¸ Delete Folder</button>
      </div>

      <label>Paid Amount (â‚¹):</label>
      <input type="number" id="paidAmount-${id}" placeholder="Enter paid amount">

      <button onclick="savePayment(${id})">ğŸ’¾ Save Payment</button>
    </div>
  `;

  document.getElementById("foldersList").insertAdjacentHTML('beforeend', folderHTML);
}

function calculateTotal(id) {
  const input = document.getElementById(`productPrice-${id}`);
  const priceList = input.value.split(',').map(p => parseFloat(p.trim()) || 0);
  const total = priceList.reduce((a, b) => a + b, 0);
  document.getElementById(`total-${id}`).textContent = total.toFixed(2);
  updateInitialSMS(id);
}

function updateInitialSMS(id) {
  const phone = document.getElementById(`phone-${id}`).value;
  const total = document.getElementById(`total-${id}`).textContent;

  const message = `From Zuber C Mevegar you have to pay your amount Near madina masjid ugar road ainapur\nAmount: â‚¹${total}`;
  document.getElementById(`call-${id}`).href = `tel:${phone}`;
}

function savePayment(id) {
  const paid = parseFloat(document.getElementById(`paidAmount-${id}`).value) || 0;
  const totalEl = document.getElementById(`total-${id}`);
  let total = parseFloat(totalEl.textContent.replace(/,/g, ''));

  if (paid > total) {
    alert("Paid amount cannot be more than the total.");
    return;
  }

  let remaining = total - paid;
  totalEl.textContent = remaining.toFixed(2);

  const phone = document.getElementById(`phone-${id}`).value;
  let message = "";

  if (paid === 0) {
    message = `From Zuber C Mevegar you have to pay your amount Near madina masjid ugar road ainapur\nAmount: â‚¹${total.toFixed(2)}`;
  } else if (remaining > 0) {
    message = `From Zuber C Mevegar you have paid your half amount please paid your all amount\nRemaining: â‚¹${remaining.toFixed(2)}`;
  } else {
    message = `From Zuber C Mevegar you have paid your full amount Thankyou`;
  }

  if (phone) {
    window.location.href = `sms:${phone}?body=${encodeURIComponent(message)}`;
  } else {
    alert("Please enter a phone number.");
  }
}

function deleteFolder(id) {
  const confirmDelete = confirm("Are you sure you want to delete this folder?");
  if (confirmDelete) {
    const folderEl = document.getElementById(`folder-${id}`);
    if (folderEl) folderEl.remove();
  }
}
</script>

</body>
</html>
